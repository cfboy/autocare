<div class="d-sm-flex justify-content-between align-items-start">
    <div>
        <h4 class="card-title card-title-dash">
            Memberships
        </h4>
    </div>
    <div class="d-sm-flex justify-content-between align-items-start float-end">
        <% if(showCreateBtn) { %>
        <a href="/create-subscriptions" class="btn btn-primary btn-icon-text text-white me-2" type="button">
            <i class="fas fa-plus btn-icon-prepend"></i>Create Memberships</a>
        <% } %>
        <% if(showManageBtn) { %>
        <a id="manage-billing-button" class="btn btn-primary btn-icon-text manage-billing-button" style="margin: 0;"
            type="submit" value="<%- customer.billingID%>" email="<%- customer.email%>">
            <i class="fab fa-stripe-s"></i> Manage Billing</a>
        <% } %>
    </div>

</div>
<div class="table-responsive mt-1">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>
                    Membership Information
                </th>
                <th>
                    Period
                    <br>
                    <small>(start date) / (end date)</small>

                </th>
                <th class="text-center">
                    Status
                </th>
            </tr>
        </thead>
        <tbody>
            <% for(stripeSubscription of subscriptions) { %>
            <tr>
                <td>
                    <% for(item of stripeSubscription.data.items.data) { %>
                    <p>
                        <b><%- item.price.product.name %></b> (<%= item.cars.length %>/<%= item.quantity%>)
                    </p>
                    <ul class="mb-0">
                        <!-- Show all item cars -->
                        <% if(item.cars.length > 0) { %>
                        <% for(car of item.cars) { %>
                        <li class="mt-0 mb-0 m-3">
                            <%- car.brand %> - <%- car.model %> - <%- car.plate %>
                        </li>
                        <% } %>
                        <% } %>
                        <!-- If the length of cars is less than item quantity, then show add car btn. -->
                        <% if(item.cars.length < item.quantity) { %>
                        <li class="mt-0 mb-0 m-3">
                            <a href="/cars/create?itemID=<%- item.id%>" id="add-car-button" class="btn btn-link p-0"
                                style="margin: 0;" type="submit">
                                Add Missing Car</a>
                            <% } %>
                        </li>
                    </ul>
                    <br>
                    <% } %>
                </td>
                <td>
                    (<%= moment(stripeSubscription?.data?.current_period_start * 1000).isValid() ? moment(stripeSubscription?.data?.current_period_start * 1000).format(shortDateFormat) : 'N/A' %>)
                    /
                    (<%= moment(stripeSubscription?.data?.current_period_end * 1000).isValid() ? moment(stripeSubscription?.data?.current_period_end * 1000).format(shortDateFormat) : 'N/A' %>)

                </td>
                <td class="text-center">
                    <span style="text-transform: uppercase;">
                        <%- stripeSubscription?.data.status%>
                    </span>
                </td>
            </tr>
            <% } %>
        </tbody>
    </table>
</div>